---
title: "示例 6.1: 使用Python/ASE的Lennard-Jones固体"
layout: single
classes: wide
lang: zh
lang-ref: example-6-1
sidebar:
  nav: "docs"
---

**下载输入文件：**
[<i class="fas fa-download"></i> Al.cell]({{ '/assets/examples/6.1/Al.cell' | relative_url }}){: .btn .btn--primary .btn--small}
[<i class="fas fa-download"></i> relax.py]({{ '/assets/examples/6.1/relax.py' | relative_url }}){: .btn .btn--primary .btn--small}

此例子如[示例 1.1]({{ '/tutorials/1.1/' | relative_url }})一样，使用随机搜索来找到Lennard-Jones固体的基态。然而，它使用来自原子模拟环境(ASE)的Lennard-Jones势，并通过`relax.py`脚本控制结构优化。种子文件与[示例 1.1]({{ '/tutorials/1.1/' | relative_url }})中的相同。

我们使用`-python`标志来执行搜索：


**`Al.cell`：**

```
%BLOCK LATTICE_CART
2 0 0
0 2 0
0 0 2
%ENDBLOCK LATTICE_CART

%BLOCK POSITIONS_FRAC
Al 0.0 0.0 0.0 # Al1 % NUM=8
%ENDBLOCK POSITIONS_FRAC

#MINSEP=1.5
```

**`relax.py`：**

```python
import numpy as np
import os
import sys

from ase import Atoms
from ase.calculators.lj import LennardJones
from ase.constraints import ExpCellFilter
from ase.optimize import LBFGSLineSearch
import ase.io

#------------------------------------------------

# Collect command line input and load random structure
pressure = float(sys.argv[1])
seed = sys.argv[2]
atoms = ase.io.read(seed + '.xyz')

# Relax cell using Lennard-Jones potential
epsilon = 1
sigma = 2
cutoff = 2.5*sigma
atoms.calc = LennardJones(sigma=sigma, epsilon=epsilon, rc=cutoff)
ecf = ExpCellFilter(atoms, scalar_pressure=pressure)
opt = LBFGSLineSearch(ecf)
converged = opt.run(steps=1000)

# If converged, output final structure and fake castep file
if converged:
    ase.io.write(seed + '-out.xyz', atoms, 'extxyz')
    volume = atoms.get_volume()
    enthalpy = atoms.get_potential_energy() + pressure*volume
    with open(seed + '.castep', 'w') as f:
        f.write("Current cell volume = {:25.15f} A**3\n".format(volume))
        f.write("*  Pressure:   {:25.15f}\n".format(pressure))
        f.write("Python: Final Enthalpy     = {:25.15f} eV\n".format(enthalpy))
```

```console
$ airss.pl -python -max 20 -seed Al
```

生成的结构为：

```console
$ ca -u 0.01 -r

Al-31158-3253-14         0.00     7.459      -7.472   8 Al           P63/mmc        2
Al-31158-3253-12         0.00     7.450       0.004   8 Al           R-3m           2
Al-31158-3253-19         0.00     7.442       0.009   8 Al           Fm-3m         12
Al-31158-3253-10         0.00     7.672       0.286   8 Al           C2/m           1
Al-31158-3253-20         0.00     8.338       0.800   8 Al           Cm             1
Al-31158-3253-13         0.00     8.344       0.803   8 Al           C2/m           1
Al-31158-3253-18         0.00     8.361       0.906   8 Al           Cm             1
```

虽然在`relax.py`中设置的Lennard-Jones参数与[示例 1.1]({{ '/tutorials/1.1/' | relative_url }})中的相同，但这里的结果略有不同（例如HCP结构的体积和能量）。要获得相同的结果，必须使用`pp3 -e`重新进行示例1.1，其中`-e`标志禁用`pp3`代码使用的力移位。

---

**上一页：** [示例 5.2: Quantum Espresso 100 GPa下氢的分子单元搜索]({{ '/tutorials/5.2/' | relative_url }}) | **下一页：** [示例 6.2: 使用Python/ASE和GAP的硅搜索]({{ '/tutorials/6.2/' | relative_url }})

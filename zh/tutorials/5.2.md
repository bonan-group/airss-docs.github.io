---
title: "示例 5.2: Quantum Espresso 100 GPa下氢的分子单元搜索"
layout: single
classes: wide
lang: zh
lang-ref: example-5-2
sidebar:
  nav: "docs"
---

**下载输入文件：**
[<i class="fas fa-download"></i> H.cell]({{ '/assets/examples/5.2/H.cell' | relative_url }}){: .btn .btn--primary .btn--small}
[<i class="fas fa-download"></i> H.qe]({{ '/assets/examples/5.2/H.qe' | relative_url }}){: .btn .btn--primary .btn--small}

在这个例子中，我们探索100 GPa下的氢。此例子与[示例 3.2]({{ '/tutorials/3.2/' | relative_url }})相同，只是我们使用Quantum Espresso进行结构松弛。

在第一部分中，我们进行自由搜索。然后从自由搜索的低焓结构中提取出现的分子单元，并使用它们进行后续的"基于单元的"搜索。

#### 近似运行时间：60分钟（自由搜索）和60分钟（单元搜索），在4个进程上并行化

## 先决条件

与[示例 5.1]({{ '/tutorials/5.1/' | relative_url }})一样，您需要安装Quantum Espresso的`pw.x`二进制文件并将其放在您的路径中。

您还需要氢的赝势。此特定示例已设置为使用来自[PSlibrary](https://dalcorso.github.io/pslibrary/)的Quantum Espresso推荐赝势。使用以下命令下载它：

```console
$ wget https://www.quantum-espresso.org/upf_files/H.pbe-rrkjus_psl.1.0.0.UPF
```

使您的当前目录中有`H.pbe-rrkjus_psl.1.0.0.UPF`文件。

## 输入文件

首先检查`H.cell`：

```console
$ cat H.cell

#VARVOL=2.5
#SPECIES=H
#NATOM=8

#SLACK=0.25
#OVERLAP=0.1
#MINSEP=1 H-H=0.7
#COMPACT

KPOINTS_MP_SPACING 0.07
```

AIRSS指令`#VARVOL=2.5`指定每个H原子2.5立方埃的体积，加减5%。我们请求氢（`#SPECIES=H`）和单位晶胞中的8个原子（`#NATOM=8`）。

`#MINSEP=0.7`设置最小H-H分离为0.7 Å。记住要避免核心重叠以防止电子结构收敛不良。

最后，指令`KPOINTS_MP_SPACING`设置k点采样密度为0.07，其中0.05更适合金属（或近金属系统）。

文件`H.qe`包含Quantum Espresso使用的DFT/松弛参数。有关这些参数的信息，请查阅[Quantum Espresso文档](https://www.quantum-espresso.org/Doc/INPUT_PW.html)。


**`H.qe`：**

```
&CONTROL
  calculation = 'vc-relax' ,
  verbosity = 'low' ,
  restart_mode = 'from_scratch' ,
  nstep = 20 ,
  tstress = .true. ,
  tprnfor = .true. ,
  outdir = './' ,
  prefix = 'xxx' ,
  max_seconds = 1.0D7 ,
  pseudo_dir = './' ,
  etot_conv_thr = 1.0D-5 ,
  forc_conv_thr = 1.0D-3 ,
  disk_io = 'none' ,
/

&SYSTEM
  ecutwfc = 46 ,
  ecutrho = 221 ,
  occupations = 'smearing' ,
  smearing = 'gaussian' ,
  degauss = 1.0D-2 ,
  ibrav = 0 ,
  nat = xxx ,
  ntyp = xxx ,
/

&ELECTRONS
  electron_maxstep = 1000 ,
  conv_thr = 1.0D-6 ,
  diagonalization = 'cg' ,
/

&IONS
  ion_dynamics = 'bfgs' ,
  trust_radius_max = 0.5D0 ,
/

&CELL
  press = xxx ,
  press_conv_thr = 0.5D0 ,
  cell_dynamics = 'bfgs' ,
  cell_dofree = 'all' ,
  cell_factor = 3.0 ,
/

ATOMIC_SPECIES
 H 1.00784 H.pbe-rrkjus_psl.1.0.0.UPF
```

## 运行示例

我们请求10个结构（`-max 10`）在100 GPa（`-press 100`）使用Quantum Espresso（`-qe`）进行松弛。您还可以添加例如`-mpinp 4`来并行运行Quantum Espresso。

```console
$ airss.pl -press 100 -max 10 -seed H -qe
```

## 检查输出

使用cryan（`ca`）获得按焓排序的列表。由于AIRSS的随机性，您的确切输出将有所不同：

```console
$ ca -r

H-10203-8632-9         100.01     2.301     -13.694   8 H            Pca21      1
H-10203-8632-1         100.00     2.302       0.000   8 H            Pca21      1
H-10203-8632-4          99.99     2.299       0.001   8 H            P21/c      1
H-10203-8632-2         100.00     2.298       0.001   8 H            P21        1
H-10203-8632-6         100.02     2.298       0.001   8 H            P212121    1
H-10203-8632-8         100.00     2.298       0.002   8 H            P212121    1
H-10203-8632-3         100.03     2.302       0.003   8 H            C2         1
H-10203-8632-5         100.03     2.302       0.003   8 H            C2         1
H-10203-8632-10        100.03     2.303       0.003   8 H            C2         1
H-10203-8632-7         100.02     2.320       0.014   8 H            P1         1
```

在这种情况下，找到的最低焓结构是`H-10203-8632-9`，其结构可以在SHX格式中找到为`H-10203-8632-9.res`。

## 提取分子单元

使用cryan代码，我们可以直接从最低焓结构中提取存在的分子单元：

```console
$ cryan -g -bs 1 < H-10203-8632-9.res > H2.cell

Degrees of freedom:    14  0.737

Number of units:        4

$ cat H2.cell

%BLOCK LATTICE_CART
   1.89131   0.00000   0.00000
  -0.00120   2.99187   0.00000
  -1.88967  -2.99300   3.25316
%ENDBLOCK LATTICE_CART

#TARGVOL=4.60

%BLOCK POSITIONS_ABS
    H  -0.90374  -1.98969   2.69356 # 1-D(inf)h % NUM=1
    H  -1.35056  -1.63007   3.14979 # 1-D(inf)h
%ENDBLOCK POSITIONS_ABS

#SYMMOPS=1
##SGRANK=20
#NFORM=4
#SLACK=0.25
#OVERLAP=0.1
#COMPACT
#CELLADAPT
#MINSEP=1.0 H-H=1.55
```

## 基于单元的搜索

我们可以使用`H2.cell`进行基于单元的搜索。从`H.cell`添加行`KPOINTS_MP_SPACING 0.07`到您的新`H2.cell`，并将`H.qe`复制到`H2.qe`。

```console
$ echo "KPOINTS_MP_SPACING 0.07" >> H2.cell
$ cp H.qe H2.qe
```

运行搜索如上所述，但指定`H2`作为种子，而不是`H`。

```console
$ airss.pl -press 100 -max 10 -seed H2 -qe
```

获取按焓排序的列表。以`H`为前缀的条目来自我们的第一次搜索，以`H2`为前缀的来自我们的第二次基于单元的搜索。

```console
$ ca -r

H-10203-8632-9         100.01     2.301     -13.694   8 H            Pca21      1
H2-21648-3658-5        100.00     2.302       0.000   8 H            Pca21      1
H2-21648-3658-2        100.02     2.302       0.000   8 H            Pca21      1
H-10203-8632-1         100.00     2.302       0.000   8 H            Pca21      1
H2-21648-3658-8        100.00     2.299       0.001   8 H            P21/c      1
H-10203-8632-4          99.99     2.299       0.001   8 H            P21/c      1
H-10203-8632-2         100.00     2.298       0.001   8 H            P21        1
H-10203-8632-6         100.02     2.298       0.001   8 H            P212121    1
H-10203-8632-8         100.00     2.298       0.002   8 H            P212121    1
H-10203-8632-3         100.03     2.302       0.003   8 H            C2         1
H-10203-8632-5         100.03     2.302       0.003   8 H            C2         1
H-10203-8632-10        100.03     2.303       0.003   8 H            C2         1
H-10203-8632-7         100.02     2.320       0.014   8 H            P1         1
H2-21648-3658-9         99.99     2.320       0.014   8 H            C2/m       1
H2-21648-3658-1        100.00     2.333       0.015   8 H            Cmce       1
H2-21648-3658-4        100.01     2.333       0.015   8 H            Cmce       1
H2-21648-3658-10        99.99     2.337       0.020   8 H            C2/c       1
H2-21648-3658-7        100.01     2.344       0.028   8 H            I4/mmm     1
H2-21648-3658-6        100.03     2.261       0.035   8 H            C2/m       1
```

---

**上一页：** [示例 5.1: Quantum Espresso 100 GPa下碳的自由搜索]({{ '/tutorials/5.1/' | relative_url }}) | **下一页：** [示例 6.1: 使用Python/ASE的Lennard-Jones固体]({{ '/tutorials/6.1/' | relative_url }})

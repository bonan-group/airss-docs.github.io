---
title: "Example 2.7: GULP CH4 Molecular Crystal Search"
layout: single
classes: wide
lang: en
lang-ref: example-2-7
sidebar:
  nav: "docs"
---

**Download input files:**
[<i class="fas fa-download"></i> CH4.cell]({{ '/assets/examples/2.7/CH4.cell' | relative_url }}){: .btn .btn--primary .btn--small}
[<i class="fas fa-download"></i> CH4.lib]({{ '/assets/examples/2.7/CH4.lib' | relative_url }}){: .btn .btn--primary .btn--small}

In this example we search for well packed methane (CH₄) molecular crystals. The Tersoff potential is used to determine the interatomic interactions, and it is expected to provide only a coarse approximation.

````bash
$ cat CH4.cell

#TARGVOL=7.69

%BLOCK POSITIONS_ABS
    C   0.86267   0.87843   0.69644 # 1-Td % NUM=1
    H  -0.15687   1.20067   0.63115 # 1-Td
    H   1.19106   0.93720   1.71422 # 1-Td
    H   0.93994  -0.13355   0.35439 # 1-Td
    H   1.47618   1.50890   0.08615 # 1-Td
%ENDBLOCK POSITIONS_ABS

#SYMMOPS=4
#SGRANK=20
#SLACK=0.25
#OVERLAP=1
##SYSTEM=Cubi
#MINSEP=1.0 C-C=2.10 C-H=1.45 H-H=1.00
````

Using this input file, `buildcell` will attempt to construct a random unit cell, choosing a space group randomly with four symmetry operators from the top 20 most common space groups for molecular crystals. The CH₄ tetrahedral unit (or molecule) is specified in absolute coordinates. All atoms are labelled in the same way (`1-Td`) to tie the atoms together into a unit. The miniumum distance constraints are first applied by shifting the molecules, using a `SLACK` parameter of 0.25 (the `MINSEP` distances are multiplied by 0.75). Once these relaxed constraints are satisfied, an optimisation using hard sphere potentials for the specified `MINSEP` distances is applied, and rotations of the unit are permitted. A final `OVERLAP` of 1 is tolerated. This may be reduced to 0.1 or lower, at a greater computational cost.


**`CH4.lib`:**

```
#
#  Tersoff bond order potentials 
#
#  NB There are several variants of the Tersoff potential - 
#  the following is Si(C) from:
#
#  H  : F. de Brito Mota, J.F. Justo and A. Fazzio, J. Appl. Phys., 86, 1843 (1999)
#  C  : J. Tersoff, Phys. Rev. Lett., 61, 2879 (1988)
#  N  : F. de Brito Mota, J.F. Justo and A. Fazzio, J. Appl. Phys., 86, 1843 (1999)
#  Si : J. Tersoff, Phys. Rev. B, 38, 9902 (1988)
#  Ge : J. Tersoff, Phys. Rev. B, 39, 5566 (1989)
#
#  Inter-species potentials derived using the combination rules of Tersoff.
#  Where no chi value is available it is assumed to be one.
#
#  Library modified to allow for the fact that borepulsive and boattractive can now
#  be pair-wise specific.
#
species
H  core 0.0
C  core 0.0
N  core 0.0
Si core 0.0
Ge core 0.0
botwobody
H  core H  core 86.71200  43.5310 3.78790 1.9800 0.8000 1.0000
C  core C  core 1393.600 346.7400 3.48790 2.2119 1.8000 2.1000
N  core N  core 636.8140 511.7600 5.43673 2.7000 1.8000 2.1000
Si core Si core 1830.800 471.1800 2.47990 1.7322 2.7000 3.0000
Ge core Ge core 1769.000 419.2300 2.44510 1.7047 2.8000 3.1000
botwobody combine
H  core C  core 1.0 1.00000
H  core N  core 1.0 0.76000
H  core Si core 1.0 0.78000
H  core Ge core 1.0 1.00000
C  core N  core 1.0 1.00000
C  core Si core 1.0 0.97760
C  core Ge core 1.0 1.00000
N  core Si core 1.0 0.65000
N  core Ge core 1.0 1.00000
Si core Ge core 1.0 1.00061
borepulsive
H  core H  core 0.0 3 1.00000 1.9800 
C  core C  core 0.0 3 0.72751 2.2119 
N  core N  core 0.0 3 1.33041 2.7000 
Si core Si core 0.0 3 0.78734 1.7322 
Ge core Ge core 0.0 3 0.75627 1.7047 
#
#  Cross terms added for compatibility with version 3.4 and earlier
#
H  core C  core 0.0 3 1.00000 1.9800 
H  core N  core 0.0 3 1.00000 1.9800 
H  core Si core 0.0 3 1.00000 1.9800 
H  core Ge core 0.0 3 1.00000 1.9800 
C  core H  core 0.0 3 0.72751 2.2119 
C  core N  core 0.0 3 0.72751 2.2119 
C  core Si core 0.0 3 0.72751 2.2119 
C  core Ge core 0.0 3 0.72751 2.2119 
N  core H  core 0.0 3 1.33041 2.7000 
N  core C  core 0.0 3 1.33041 2.7000 
N  core Si core 0.0 3 1.33041 2.7000 
N  core Ge core 0.0 3 1.33041 2.7000 
Si core H  core 0.0 3 0.78734 1.7322 
Si core C  core 0.0 3 0.78734 1.7322 
Si core N  core 0.0 3 0.78734 1.7322 
Si core Ge core 0.0 3 0.78734 1.7322 
Ge core H  core 0.0 3 0.75627 1.7047 
Ge core C  core 0.0 3 0.75627 1.7047 
Ge core N  core 0.0 3 0.75627 1.7047 
Ge core Si core 0.0 3 0.75627 1.7047 
boattractive theta
H  core H  core 4.00000000000 3 1.00000 1.9800      0.0  1.0000  1.00000 
C  core C  core 0.00000015724 3 0.72751 2.2119  38049.0  4.3484 -0.57058 
N  core N  core 0.00529380000 3 1.33041 2.7000  20312.0 25.5103 -0.56239 
Si core Si core 0.00000109990 3 0.78734 1.7322 100390.0 16.2180 -0.59826 
Ge core Ge core 0.00000090166 3 0.75627 1.7047 100643.0 15.6520 -0.43884 
#
#  Cross terms added for compatibility with version 3.4 and earlier
#
H  core C  core 4.00000000000 3 1.00000 1.9800      0.0  1.0000  1.00000 
H  core N  core 4.00000000000 3 1.00000 1.9800      0.0  1.0000  1.00000 
H  core Si core 4.00000000000 3 1.00000 1.9800      0.0  1.0000  1.00000 
H  core Ge core 4.00000000000 3 1.00000 1.9800      0.0  1.0000  1.00000 
C  core H  core 0.00000015724 3 0.72751 2.2119  38049.0  4.3484 -0.57058 
C  core N  core 0.00000015724 3 0.72751 2.2119  38049.0  4.3484 -0.57058 
C  core Si core 0.00000015724 3 0.72751 2.2119  38049.0  4.3484 -0.57058 
C  core Ge core 0.00000015724 3 0.72751 2.2119  38049.0  4.3484 -0.57058 
N  core H  core 0.00529380000 3 1.33041 2.7000  20312.0 25.5103 -0.56239 
N  core C  core 0.00529380000 3 1.33041 2.7000  20312.0 25.5103 -0.56239 
N  core Si core 0.00529380000 3 1.33041 2.7000  20312.0 25.5103 -0.56239 
N  core Ge core 0.00529380000 3 1.33041 2.7000  20312.0 25.5103 -0.56239 
Si core H  core 0.00000109990 3 0.78734 1.7322 100390.0 16.2180 -0.59826 
Si core C  core 0.00000109990 3 0.78734 1.7322 100390.0 16.2180 -0.59826 
Si core N  core 0.00000109990 3 0.78734 1.7322 100390.0 16.2180 -0.59826 
Si core Ge core 0.00000109990 3 0.78734 1.7322 100390.0 16.2180 -0.59826 
Ge core H  core 0.00000090166 3 0.75627 1.7047 100643.0 15.6520 -0.43884 
Ge core C  core 0.00000090166 3 0.75627 1.7047 100643.0 15.6520 -0.43884 
Ge core N  core 0.00000090166 3 0.75627 1.7047 100643.0 15.6520 -0.43884 
Ge core Si core 0.00000090166 3 0.75627 1.7047 100643.0 15.6520 -0.43884
```

````bash
$ airss.pl -gulp -press 1 -max 10 -seed CH4
````

A pressure of 1 GPa is applied to favour well-packed solutions.

````bash
$ ca -r

CH4-32238-381-10         1.00     8.111     -20.738   4 CH4          P212121    1
CH4-32238-381-8          1.00     8.390       0.002   4 CH4          P212121    1
CH4-32238-381-5          1.00     8.516       0.003   4 CH4          P21        1
CH4-32238-381-9          1.00     8.606       0.003   4 CH4          Pca21      1
CH4-32238-381-2          1.00     8.538       0.003   4 CH4          Pca21      1
CH4-32238-381-3          1.00     8.660       0.003   4 CH4          Pca21      1
CH4-32238-381-4          1.00     8.881       0.005   4 CH4          P21212     1
CH4-32238-381-1          1.00     8.902       0.005   4 CH4          P21        1
CH4-32238-381-6          1.00     9.625       0.009   4 CH4          P21212     1
CH4-32238-381-7          1.00     8.980       0.730   4 CH4          P1         1
````

The ten samples above are not exhaustive. A low energy solution is known to be cubic with space group `P213`, and cubic solutions can be encouraged by uncommenting the `SYSTEM=Cubi` line in `CH4.cell`.

---

**Previous:** [Example 2.6: GULP SiO2 Cluster Search]({{ '/tutorials/2.6/' | relative_url }}) | **Next:** [Example 3.1: CASTEP Free Search for Carbon at 100 GPa]({{ '/tutorials/3.1/' | relative_url }})

---
title: "Example 6.1: Lennard-Jones Solid using Python/ASE"
layout: single
classes: wide
lang: en
lang-ref: example-6-1
sidebar:
  nav: "docs"
---

**Download input files:**
[<i class="fas fa-download"></i> Al.cell]({{ '/assets/examples/6.1/Al.cell' | relative_url }}){: .btn .btn--primary .btn--small}
[<i class="fas fa-download"></i> relax.py]({{ '/assets/examples/6.1/relax.py' | relative_url }}){: .btn .btn--primary .btn--small}

This example, like [Example 1.1]({{ '/tutorials/1.1/' | relative_url }}), uses random searching to find the ground state of a Lennard-Jones solid. However, it uses the Lennard-Jones potential from the Atomic Simulation Environment (ASE), with structural optimisations controlled by the `relax.py` script. The seed file is identical to that from [Example 1.1]({{ '/tutorials/1.1/' | relative_url }}).

We use the `-python` flag to perform the search:


**`Al.cell`:**

```
%BLOCK LATTICE_CART
2 0 0
0 2 0
0 0 2 
%ENDBLOCK LATTICE_CART
 
%BLOCK POSITIONS_FRAC
Al 0.0 0.0 0.0 # Al1 % NUM=8
%ENDBLOCK POSITIONS_FRAC

#MINSEP=1.5
```

**`relax.py`:**

```python
import numpy as np
import os
import sys

from ase import Atoms
from ase.calculators.lj import LennardJones
from ase.constraints import ExpCellFilter
from ase.optimize import LBFGSLineSearch
import ase.io

#------------------------------------------------

# Collect command line input and load random structure
pressure = float(sys.argv[1])
seed = sys.argv[2]
atoms = ase.io.read(seed + '.xyz')

# Relax cell using Lennard-Jones potential
epsilon = 1
sigma = 2
cutoff = 2.5*sigma
atoms.calc = LennardJones(sigma=sigma, epsilon=epsilon, rc=cutoff)
ecf = ExpCellFilter(atoms, scalar_pressure=pressure)
opt = LBFGSLineSearch(ecf)	
converged = opt.run(steps=1000)

# If converged, output final structure and fake castep file
if converged:
    ase.io.write(seed + '-out.xyz', atoms, 'extxyz')
    volume = atoms.get_volume()
    enthalpy = atoms.get_potential_energy() + pressure*volume
    with open(seed + '.castep', 'w') as f:
        f.write("Current cell volume = {:25.15f} A**3\n".format(volume))
        f.write("*  Pressure:   {:25.15f}\n".format(pressure))
        f.write("Python: Final Enthalpy     = {:25.15f} eV\n".format(enthalpy))
```

```console
$ airss.pl -python -max 20 -seed Al
```

and the resulting structures are:

```console
$ ca -u 0.01 -r

Al-31158-3253-14         0.00     7.459      -7.472   8 Al           P63/mmc        2
Al-31158-3253-12         0.00     7.450       0.004   8 Al           R-3m           2
Al-31158-3253-19         0.00     7.442       0.009   8 Al           Fm-3m         12
Al-31158-3253-10         0.00     7.672       0.286   8 Al           C2/m           1
Al-31158-3253-20         0.00     8.338       0.800   8 Al           Cm             1
Al-31158-3253-13         0.00     8.344       0.803   8 Al           C2/m           1
Al-31158-3253-18         0.00     8.361       0.906   8 Al           Cm             1
```

While the Lennard-Jones parameters set in `relax.py` are the same as those from [Example 1.1]({{ '/tutorials/1.1/' | relative_url }}), the results here differ slightly (e.g., the volume and energy for the HCP structure). To obtain identical results, one must redo Example 1.1 using `pp3 -e`, where the `-e` flag disables force shifting employed by the `pp3` code.

---

**Previous:** [Example 5.2: Quantum Espresso Hydrogen at 100 GPa with Molecular Units]({{ '/tutorials/5.2/' | relative_url }}) | **Next:** [Example 6.2: Silicon Search using Python/ASE with GAP]({{ '/tutorials/6.2/' | relative_url }})
